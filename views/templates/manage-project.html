<div class="container">     
    <form name="manageProject" id="manageProject" ng-submit="manageProject.$valid" novalidate >
        <div>
            <table class="table table-bordered" ng-disabled="manageProject.$invalid">
                <tr><th>Subject</th><th>Session</th><th>Dose</th><th>Projects per page</th></tr>
                <tr>
                    <td>
                        <input class="form-control" type="text" ng-model="search.subject.nick"/>
                    </td>
                    <td>
                        <input class="form-control" type="text" ng-model="search.session.name"/>
                    </td>
                    <td>
                        <input class="form-control" type="text" ng-model="search.dose"/>
                    </td>
                    <td>
                        <input type="number" min="1" max="100" class="form-control" ng-model="pageSize"/>
                    </td>
                </tr>
            </table>
        </div>
        <table class="table">
            <thead>
                <tr>
                    <th>Subject <a title="Add new subject to the project" class="btn btn-default btn-sm btn-subject" data-toggle="modal" data-target="#newSubject"><span class="glyphicon glyphicon-plus"></span></a></th>
                    <th>Viability</th>
                    <th>Side Effects</th>
                    <th>Dose (mg)</th>
                    <th>Reaction</th>
                    <th class="th-width">Session <a title="Add new sesion" class="btn btn-default btn-sm btn-subject" confirmed-click="projectCtrl.closeSession()" ng-confirm-click="Are you sure to close the opened session? This step can not be undone" ><span class="glyphicon glyphicon-plus"></span></a></th>
                    <th class="th-width">Phase <a title="Add new phase" class="btn btn-default btn-sm btn-subject" confirmed-click="$parent.action=7" ng-confirm-click="Are you sure to close the opened session? This step can not be undone" ><span class="glyphicon glyphicon-plus"></span></a></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr dir-paginate="dispense in filteredData | orderBy:'dispense.session.id' | itemsPerPage: pageSize | filter:search:strict" current-page="currentPage">
                    <td>{{dispense.subject.nick}}</td>
                    <td>{{dispense.viability}}</td>
                    <td>{{dispense.sideEffects}}</td>
                    <td>{{dispense.dose}}</td>
                    <td>{{dispense.reaction}}</td>                    
                    <td>{{dispense.session.name}}</td>                    
                    <td>{{dispense.phase.id}}</td>                    
                    <td></td>                    
                </tr> 
                <tr>
                    <td>
                        <select required="required" class="form-control" ng-model="dispense.subject" ng-options="subject.getNick() for subject in subjectsProjectArray"></select>   
                    </td>
                    <td>
                        <select required="required" class="form-control" ng-model="dispense.viability" ng-options="viability for viability in viabilityArray"></select>   
                    </td>  
                    <td>
                        <input required="required" type="text" ng-model="dispense.sideEffects" class="form-control" /> 
                    </td>  
                    <td>
                        <input required="required" type="number" min="0" step="0.01" ng-model="dispense.dose" class="form-control" /> 
                    </td>  
                    <td>
                        <input required="required" type="text" ng-model="dispense.reaction" class="form-control" /> 
                    </td>  
                    <td>
                        {{session.getId()}}   
                    </td>  
                    <td>
                        {{phase.getId()}}
                    </td>   
                    <td>
                        <button ng-click="projectCtrl.addDispense()" ng-disabled="manageProject.$invalid" type="button" class="btn btn-success btn-sm">
                            <span class="glyphicon glyphicon-ok glyphicon-md"></span> 
                        </button>
                    </td>               
                </tr>
            </tbody>
        </table>
        <div>
            <div class="text-left" boundary-links="true">
                <dir-pagination-controls boundary-links="true" template-url="views/templates/dir-pagination-controls.html"></dir-pagination-controls>
            </div>
        </div>
    </form>
    <div class="alert alert-success" ng-show="msg==2">
        <strong>Success!</strong> Dispense added correctly.
    </div>
    <div class="alert alert-success" ng-show="msg==3">
        <strong>Success!</strong> Dispense updated correctly.
    </div>
    <div class="alert alert-success" ng-show="msg==4">
        <strong>Success!</strong> Subject inserted correctly.
    </div>
    <div class="alert alert-success" ng-show="msg==6">
        <strong>Success!</strong> Session added correctly.
    </div>
    <div class="alert alert-danger" ng-show="msg==7">
        <strong>Danger!</strong> Session not inserted.
    </div>
</div>
<div id="newSubject" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Add a new subject</h4>
            </div>
            <form name="addSubject" ng-submit="addSubject.$valid" novalidate >
                <div class="modal-body">
                    <div class="form-group">
                        <label for="bornDate">Born date:</label>
                        <input type="text" class="form-control"
                            id="bornDate"
                            uib-datepicker-popup="{{format}}"
                            is-open="bornDate.opened"
                            datepicker-options="bornDateOptions"
                            close-text="Close"
                            ng-required="true"
                            ng-model="newSubject.bornDate"
                            ng-click="openBornDate()"
                            readonly/>
                    </div>
                    <div class="form-group">
                        <label>Gender:</label>
                        <div class="radio">
                            <label><input value="M" type="radio" ng-model="newSubject.gender" name="gender" required>Man</label>
                        </div>
                        <div class="radio">
                            <label><input value="F" type="radio" ng-model="newSubject.gender" name="gender">Female</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="breed">Breed:</label>
                        <input required="required" type="text" ng-model="newSubject.breed" class="form-control" id="breed">
                    </div>
                    <div class="form-group">
                        <label for="breed">Height:</label>
                        <input required="required" type="number" step="0.01" ng-model="newSubject.height" class="form-control" id="height">
                    </div>
                    <div class="form-group">
                        <label for="breed">Weight:</label>
                        <input required="required" type="number" ng-model="newSubject.weight" class="form-control" id="weight">
                    </div>
                    <div class="form-group">
                        <label for="nick">Nick:</label>
                        <input required="required" type="text" ng-model="newSubject.nick" class="form-control" id="nick">
                    </div>
                    <div class="form-group">
                        <label for="bloodType">Blood Type:</label>
                        <select required="required" class="form-control" ng-model="newSubject.bloodType" ng-options="bloodType for bloodType in bloodTypeArray"></select>   
                    </div>
                    <div class="form-group">
                        <label for="status">Status:</label>
                        <select required="required" class="form-control" ng-model="newSubject.status" ng-options="status for status in statusArray"></select>   
                    </div>
                    <div class="form-group">
                        <label for="country">Country:</label>
                        <select required="required" class="form-control" ng-model="newSubject.country" ng-options="country.getName() for country in countryArray"></select>   
                    </div>
                    <div class="form-group">
                        <p>Medicament:</p>
                        <label ng-repeat="medicament in medicamentArray" class="checkbox-inline"><input class="checkbox-line" type="checkbox" id="med{{$index}}" ng-click="projectCtrl.newSubMedicaments(medicament)" />{{medicament.getName()}}</label>
                    </div>
                    <div class="form-group">
                        <p>Disease:</p>
                        <label ng-repeat="disease in diseaseArray" class="checkbox-inline"><input class="checkbox-line" type="checkbox" id="dis{{$index}}" ng-click="projectCtrl.newSubDisease(disease)" />{{disease.getName()}}</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="alert alert-danger" ng-show="msg==5">
                        <strong>Danger!</strong> Subject not inserted. Review the data introduced.
                    </div>
                    <div class="btn-group">
                        <button ng-click="projectCtrl.addSubject()" ng-disabled="addSubject.$invalid" type="button" class="btn btn-success btn-sm">
                            <span class="glyphicon glyphicon-ok glyphicon-md"></span> 
                        </button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div id="newSession" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Add a new session</h4>
            </div>
            <form name="addSession" ng-submit="addSession.$valid" novalidate >
                <div class="modal-body">                    
                    <div class="form-group">
                        <label for="breed">Session name's:</label>
                        <input required="required" type="text" ng-model="newSession.name" class="form-control" id="sessioName">
                    </div>                    
                </div>
                <div class="modal-footer">
                    <div class="alert alert-danger" ng-show="msg==8">
                        <strong>Danger!</strong> Session not inserted. Review the data introduced.
                    </div>
                    <div class="btn-group">
                        <button ng-click="projectCtrl.addSession()" ng-disabled="addSession.$invalid" type="button" class="btn btn-success btn-sm">
                            <span class="glyphicon glyphicon-ok glyphicon-md"></span> 
                        </button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>